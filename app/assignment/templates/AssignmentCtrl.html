<nav year="{{ year }}" term-code="{{ termCode }}" workgroup-code="{{ workgroupCode }}"></nav>

<div class="main-content">
	<h3 style="text-align: center;">Assignments</h3>

	<div class="row" style="margin-bottom: 2em;">
		<div class="col-sm-offset-3 col-sm-6">
			<input type="search" class="form-control" placeholder="Search" />
		</div>
	</div>

	<div class="row" style="margin-bottom: 1em;">
		<div class="col-sm-3">
			<div class="btn-group" data-toggle="buttons">
				<label class="btn btn-white btn-sm active" id="courses-pivot" ng-click="showCourses()">
					<input type="radio" name="options">
					<span class="tool-icon glyphicon glyphicon-education"></span> By Course
				</label>
				<label class="btn btn-white btn-sm" id="instructors-pivot" ng-click="showInstructors()">
					<input type="radio" name="options">
					<span class="tool-icon glyphicon glyphicon-user"></span> By Instructor
				</label>
			</div>
		</div>
		<div class="col-sm-2">
			<span>
				<a class="btn btn-block btn-default begin-teaching-call-button" ng-click="openTeachingCallConfig()">
					Create Teaching Call
				</a>
			</span>
		</div>
	</div>

	<div course-assignment-table id="courses-table" ng-show="view.state.userInterface.showCourses"></div>


	<div id="instructors-table" ng-show="view.state.userInterface.showInstructors">
		<div class="course-list-row">
			<div class="course-header description-cell">
				Instructor
			</div>
			<div class="term-header term-cell"
				ng-repeat="scheduleTermStateTermCode in view.state.scheduleTermStates.ids"
				ng-init="termCode = view.state.scheduleTermStates.list[scheduleTermStateTermCode].termCode"
				ng-if="view.state.scheduleTermStates.list[view.state.scheduleTermStates.list[scheduleTermStateTermCode].termCode].isHidden == false">
				{{ termCode.getTermCodeDisplayName(true) }}
			</div>
		</div>

		<!-- instructor-row repeating -->
		<div class="course-list-row" ng-repeat="instructorId in view.state.instructors.ids"
		ng-init="instructor=view.state.instructors.list[instructorId]">
			<div class="description-cell">
				<strong>{{ instructor.fullName }}</strong>
			</div>
			<!-- instructor teachingAssignments over time -->
			<div class="term-cell"
				ng-repeat="scheduleTermStateTermCode in view.state.scheduleTermStates.ids"
				ng-init="termCode = view.state.scheduleTermStates.list[scheduleTermStateTermCode].termCode"
				ng-if="view.state.scheduleTermStates.list[view.state.scheduleTermStates.list[scheduleTermStateTermCode].termCode].isHidden == false">

				<!-- Approved teachingAssignments within a term -->
				<div ng-repeat="teachingAssignmentId in view.state.instructors.list[instructor.id].teachingAssignmentTermCodeIds[termCode]"
					class="alert alert-info tile-assignment"
					ng-if="view.state.teachingAssignments.list[teachingAssignmentId].approved"
					ng-init="course=view.state.courses.list[view.state.sectionGroups.list[view.state.teachingAssignments.list[teachingAssignmentId].sectionGroupId].courseId]">
					<p>{{ course.subjectCode }} {{ course.courseNumber }} - {{ course.sequencePattern }}</p>
					<div class="tile-assignment-details"
					ng-init="sectionGroup=view.state.sectionGroups.list[view.state.teachingAssignments.list[teachingAssignmentId].sectionGroupId]">
						<small>Seats: {{ sectionGroup.plannedSeats }}</small>
						<br />
						<small>Units: {{ course.unitsLow }}</small>
					</div>
					<i class="btn glyphicon glyphicon-remove assignment-remove text-primary" data-toggle="tooltip" data-placement="top"
						title="" data-original-title="Unassign" data-container="body"
						ng-click="unapproveInstructorAssignment(teachingAssignmentId)"></i>
				</div>
				<div class="dropdown assign-dropdown">
					<button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
						Assign..
						<span class="caret"></span>
					</button>
					<ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
						<li ng-if="instructor.teachingAssignmentTermCodeIds[scheduleTermStateTermCode].length > 0">
							<div class="dropdown-assign-header">Interested</div>
						</li>
						<!-- Show option if the TeachingAssignments parent Course is not being suppressed and Assignment is not already approved -->
						<li ng-repeat="teachingAssignmentId in instructor.teachingAssignmentTermCodeIds[scheduleTermStateTermCode]"
						ng-if="( view.state.teachingAssignments.list[teachingAssignmentId].approved == false ) && (view.state.courses.list[view.state.sectionGroups.list[view.state.teachingAssignments.list[teachingAssignmentId].sectionGroupId].courseId].isHidden == false) "
						ng-init="course=view.state.courses.list[view.state.sectionGroups.list[view.state.teachingAssignments.list[teachingAssignmentId].sectionGroupId].courseId]">
							<a href="#" ng-click="approveInstructorAssignment(teachingAssignmentId)">{{ course.subjectCode }} {{ course.courseNumber }} - {{ course.sequencePattern }}</a>
						</li>
						<li>
							<div class="dropdown-assign-header">All</div>
						</li>
						<!-- Show option if course has a sectionGroup in this term -->
						<li ng-repeat="courseId in view.state.courses.ids"
							ng-init="course=view.state.courses.list[courseId];"
							ng-if="view.state.courses.list[courseId].sectionGroupTermCodeIds[termCode]">
							<a href="#" ng-click="addAndApproveInstructorAssignment(view.state.courses.list[courseId].sectionGroupTermCodeIds[termCode], instructorId, termCode)">{{ course.subjectCode }} {{ course.courseNumber }} - {{ course.sequencePattern }}</a>
						</li>
					</ul>
			</div><!-- term cell -->
		</div> <!-- course list row -->
	</div> <!-- instructors-list -->
</div>