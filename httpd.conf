<IfModule mod_ssl.c>
	<VirtualHost ipa.ucdavis.edu:443>
		ServerAdmin root@ipa.ucdavis.edu

		DocumentRoot /var/www/html

		LogLevel info ssl:warn

		ErrorLog ${APACHE_LOG_DIR}/error.log
		CustomLog ${APACHE_LOG_DIR}/access.log combined

		SSLEngine on

		SSLCertificateFile	/etc/ssl/certs/ipa_ucdavis_edu_cert.cer
		SSLCertificateKeyFile /etc/ssl/private/ipa_ucdavis_edu.key

		SSLCertificateChainFile /etc/ssl/certs/ipa_ucdavis_edu_interm.cer

		<FilesMatch "\.(cgi|shtml|phtml|php)$">
				SSLOptions +StdEnvVars
		</FilesMatch>
		<Directory /usr/lib/cgi-bin>
				SSLOptions +StdEnvVars
		</Directory>
		<Directory /var/www/html>
			Options -Indexes -FollowSymLinks
                	AllowOverride none
			LogLevel debug

			RewriteEngine on

			RewriteRule ^admin(.*)(?<!\.html)$ admin.html [L]
			RewriteRule ^workgroups(.*)(?<!\.html)$ workgroup.html [L]
			RewriteRule ^summary(.*)(?<!\.html)$ summary.html [L]
			RewriteRule ^courses(.*)(?<!\.html)$ course.html [L]
			RewriteRule ^assignments(.*)(?<!\.html)$ assignment.html [L]
			RewriteRule ^teachingCalls(.*)(?<!\.html)$ teachingCall.html [L]
			RewriteRule ^scheduling(.*)(?<!\.html)$ scheduling.html [L]
		</Directory>

		BrowserMatch "MSIE [2-6]" \
				nokeepalive ssl-unclean-shutdown \
				downgrade-1.0 force-response-1.0
		# MSIE 7 and newer should be able to use keepalive
		BrowserMatch "MSIE [17-9]" ssl-unclean-shutdown

		#Added by Chris Brick to manage the SSL options for best cipher/ssl hardness :-)
		SSLProtocol -all +TLSv1.2 +TLSv1.1 +TLSv1 -SSLv3 -SSLv2

		SSLHonorCipherOrder on

		SSLCipherSuite "EECDH+ECDSA+AESGCM EECDH+aRSA+AESGCM EECDH+ECDSA+SHA384 EECDH+ECDSA+SHA256 EECDH+aRSA+SHA384 EECDH+aRSA+SHA256 EECDH+aRSA+RC4 EECDH EDH+aRSA RC4 !aNULL !eNULL !LOW !3DES !MD5 !EXP !PSK !SRP !DSS"

	</VirtualHost>
</IfModule>

